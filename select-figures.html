<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Select figures &#8212; How They Think</title>
  <meta property="og:title" content="Select figures — How They Think">
  <meta property="og:description" content="An online book about how ChatGPT works">
  <meta property="og:image" content="https://ericsilberstein1.github.io/how-they-think-book/images/ogimage.png">
  <meta property="og:type" content="article">
  <meta name="twitter:card" content="summary_large_image">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <nav class="chapter-nav">
    <a href="chapter-30.html">&#8592; Previous</a>
    <a href="index.html">Contents</a>
    <a href="further-reading-and-resources.html">Next &#8594;</a>
  </nav>
  <article>
    <div class="chapter-heading">
      <h1>Select figures</h1>
    </div>
    <p>I had fun drawing / spreadsheeting / plotting / screenshotting 370 figures and tables. Here are a few that are useful and/or will give you a sense for the contents of <em>How They Think: Satisfying my curiosity about how ChatGPT works.</em></p>
    <figure>
      <input type="checkbox" id="lb-376" class="lightbox-toggle">
      <label for="lb-376"><img src="images/RC184.png" alt="" loading="lazy"></label>
      <label for="lb-376" class="lightbox-overlay"><img src="images/RC184.png" alt=""></label>
      <figcaption><a href="chapter-16.html#fig-16-1" class="xref">Figure 16.1</a> from <a href="chapter-16.html" class="xref">The whole model</a>. The full Nanochat model.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-377" class="lightbox-toggle">
      <label for="lb-377"><img src="images/RC083.png" alt="" loading="lazy"></label>
      <label for="lb-377" class="lightbox-overlay"><img src="images/RC083.png" alt=""></label>
      <figcaption><a href="chapter-9.html#fig-9-3" class="xref">Figure 9.3</a> from <a href="chapter-9.html" class="xref">Generating text</a>. Predictions for the tokens after “the” and “also.”</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-378" class="lightbox-toggle">
      <label for="lb-378"><img src="images/RC128.png" alt="" loading="lazy"></label>
      <label for="lb-378" class="lightbox-overlay"><img src="images/RC128.png" alt=""></label>
      <figcaption><a href="chapter-11.html#fig-11-9" class="xref">Figure 11.9</a> from <a href="chapter-11.html" class="xref">Cracking open the transformer</a>. The embeddings for 9 tokens projected from 1280 dimensions to 3 dimensions.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-379" class="lightbox-toggle">
      <label for="lb-379"><img src="images/RC156.png" alt="" loading="lazy" style="max-width:70%"></label>
      <label for="lb-379" class="lightbox-overlay"><img src="images/RC156.png" alt=""></label>
      <figcaption><a href="chapter-14.html#fig-14-4" class="xref">Figure 14.4</a> from <a href="chapter-14.html" class="xref">Attention</a>. While making a token prediction for position 3, the model must not be allowed to cheat by using information from positions 4 or 5.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-380" class="lightbox-toggle">
      <label for="lb-380"><img src="images/RC150.png" alt="" loading="lazy" style="max-width:70%"></label>
      <label for="lb-380" class="lightbox-overlay"><img src="images/RC150.png" alt=""></label>
      <figcaption><a href="chapter-14.html#fig-14-1" class="xref">Figure 14.1</a> from <a href="chapter-14.html" class="xref">Attention</a>. The keys for positions 1–5 in black and the query for position 5 in red.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-381" class="lightbox-toggle">
      <label for="lb-381"><img src="images/RC161.png" alt="" loading="lazy"></label>
      <label for="lb-381" class="lightbox-overlay"><img src="images/RC161.png" alt=""></label>
      <figcaption><a href="chapter-14.html#fig-14-6" class="xref">Figure 14.6</a> from <a href="chapter-14.html" class="xref">Attention</a>. Example scaled dot product attention calculation.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-382" class="lightbox-toggle">
      <label for="lb-382"><img src="images/RC196.jpg" alt="" loading="lazy" style="max-width:60%"></label>
      <label for="lb-382" class="lightbox-overlay"><img src="images/RC196.jpg" alt=""></label>
      <figcaption><a href="chapter-17.html#fig-17-4" class="xref">Figure 17.4</a> from <a href="chapter-17.html" class="xref">KV cache</a>. A BASIC loop that multiplies 0.1234567 and 0.9876543 1000 times on an Apple IIe.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-383" class="lightbox-toggle">
      <label for="lb-383"><img src="images/RC223.png" alt="" loading="lazy"></label>
      <label for="lb-383" class="lightbox-overlay"><img src="images/RC223.png" alt=""></label>
      <figcaption><a href="chapter-19.html#fig-19-6" class="xref">Figure 19.6</a> from <a href="chapter-19.html" class="xref">Now is it time to train? First: optimizers</a>. Out of control gradient descent.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-384" class="lightbox-toggle">
      <label for="lb-384"><img src="images/RC237.png" alt="" loading="lazy"></label>
      <label for="lb-384" class="lightbox-overlay"><img src="images/RC237.png" alt=""></label>
      <figcaption><a href="chapter-20.html#fig-20-2" class="xref">Figure 20.2</a> from <a href="chapter-20.html" class="xref">Adam</a>. First 100 steps of gradient descent controlled by Adam optimizer with an intentionally huge learning rate.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-385" class="lightbox-toggle">
      <label for="lb-385"><img src="images/RC310.png" alt="" loading="lazy"></label>
      <label for="lb-385" class="lightbox-overlay"><img src="images/RC310.png" alt=""></label>
      <figcaption><a href="chapter-21.html#fig-21-9" class="xref">Figure 21.9</a> from <a href="chapter-21.html" class="xref">Muon</a>. Training with a horrible loss function for 100 steps with weight updated by subtracting a small multiple of the orthogonalized gradient.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-386" class="lightbox-toggle">
      <label for="lb-386"><img src="images/RC256.png" alt="" loading="lazy"></label>
      <label for="lb-386" class="lightbox-overlay"><img src="images/RC256.png" alt=""></label>
      <figcaption><a href="chapter-23.html#fig-23-6" class="xref">Figure 23.6</a> from <a href="chapter-23.html" class="xref">Multiple GPUs</a>. Each GPU is responsible for optimizing a portion of the parameters.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-387" class="lightbox-toggle">
      <label for="lb-387"><img src="images/RC312.png" alt="" loading="lazy" style="max-width:90%"></label>
      <label for="lb-387" class="lightbox-overlay"><img src="images/RC312.png" alt=""></label>
      <figcaption><a href="chapter-24.html#fig-24-2" class="xref">Figure 24.2</a> from <a href="chapter-24.html" class="xref">Time to train! Base training.</a> GPU temperature during training.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-388" class="lightbox-toggle">
      <label for="lb-388"><img src="images/RC324.png" alt="" loading="lazy" style="max-width:90%"></label>
      <label for="lb-388" class="lightbox-overlay"><img src="images/RC324.png" alt=""></label>
      <figcaption><a href="chapter-24.html#fig-24-14" class="xref">Figure 24.14</a> from <a href="chapter-24.html" class="xref">Time to train! Base training.</a> CORE metric measured every 2000 steps during base training.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-389" class="lightbox-toggle">
      <label for="lb-389"><img src="images/RC265.png" alt="" loading="lazy" style="max-width:70%"></label>
      <label for="lb-389" class="lightbox-overlay"><img src="images/RC265.png" alt=""></label>
      <figcaption><a href="chapter-24.html#fig-24-20" class="xref">Figure 24.20</a> from <a href="chapter-24.html" class="xref">Time to train! Base training.</a> Probabilities predicted by the model for the multiple choice answers to “Which explains how the epithelium offers protection to land-dwelling vertebrates?”</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-390" class="lightbox-toggle">
      <label for="lb-390"><img src="images/RC278.png" alt="" loading="lazy"></label>
      <label for="lb-390" class="lightbox-overlay"><img src="images/RC278.png" alt=""></label>
      <figcaption><a href="chapter-26.html#fig-26-1" class="xref">Figure 26.1</a> from <a href="chapter-26.html" class="xref">Opposable thumbs: the tool dance</a>. The engine surrounding the model calls the Python calculator and appends the result to the token stream for the model to read.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-391" class="lightbox-toggle">
      <label for="lb-391"><img src="images/RC332.png" alt="" loading="lazy"></label>
      <label for="lb-391" class="lightbox-overlay"><img src="images/RC332.png" alt=""></label>
      <figcaption><a href="chapter-27.html#fig-27-1" class="xref">Figure 27.1</a> from <a href="chapter-27.html" class="xref">Supervised fine-tuning</a>. The user and assistant tokens in each of the four example conversations for supervised fine-tuning.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-392" class="lightbox-toggle">
      <label for="lb-392"><img src="images/RC286.png" alt="" loading="lazy"></label>
      <label for="lb-392" class="lightbox-overlay"><img src="images/RC286.png" alt=""></label>
      <figcaption><a href="chapter-28.html#fig-28-2" class="xref">Figure 28.2</a> from <a href="chapter-28.html" class="xref">Reinforcement learning</a>. In reinforcement learning, we use the model to generate training data.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-393" class="lightbox-toggle">
      <label for="lb-393"><img src="images/RC293.png" alt="" loading="lazy"></label>
      <label for="lb-393" class="lightbox-overlay"><img src="images/RC293.png" alt=""></label>
      <figcaption><a href="chapter-28.html#tbl-28-7" class="xref">Table 28.7</a> from <a href="chapter-28.html" class="xref">Reinforcement learning</a>. Nine generated solutions for a single word problem.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-394" class="lightbox-toggle">
      <label for="lb-394"><img src="images/RC296.png" alt="" loading="lazy"></label>
      <label for="lb-394" class="lightbox-overlay"><img src="images/RC296.png" alt=""></label>
      <figcaption><a href="chapter-29.html#fig-29-2" class="xref">Figure 29.2</a> from <a href="chapter-29.html" class="xref">Hello model!</a> User → assistant → user → assistant.</figcaption>
    </figure>
    <figure>
      <input type="checkbox" id="lb-395" class="lightbox-toggle">
      <label for="lb-395"><img src="images/RC362.png" alt="" loading="lazy" style="max-width:70%"></label>
      <label for="lb-395" class="lightbox-overlay"><img src="images/RC362.png" alt=""></label>
      <figcaption><a href="chapter-30.html#fig-30-8" class="xref">Figure 30.8</a> from <a href="chapter-30.html" class="xref">Being precise about precision</a>. The bits of a bfloat16 number.</figcaption>
    </figure>
  </article>
  <nav class="chapter-nav">
    <a href="chapter-30.html">&#8592; Previous</a>
    <a href="index.html">Contents</a>
    <a href="further-reading-and-resources.html">Next &#8594;</a>
  </nav>
  <footer class="site-footer"><em>How They Think</em> &mdash; February 12, 2026 draft &mdash; &copy; Eric Silberstein</footer>
  <div id="preview-tooltip" class="preview-tooltip" hidden>
    <img id="preview-tooltip-img" src="" alt="">
  </div>
  <script>
  (function() {
    var tip = document.getElementById('preview-tooltip');
    var img = document.getElementById('preview-tooltip-img');
    var links = document.querySelectorAll('a.xref[data-preview]');
    var hideTimer;
    function show(e) {
      clearTimeout(hideTimer);
      var src = e.currentTarget.getAttribute('data-preview');
      if (img.getAttribute('src') !== src) img.setAttribute('src', src);
      tip.removeAttribute('hidden');
      position(e);
    }
    function position(e) {
      var rect = e.currentTarget.getBoundingClientRect();
      var tw = Math.min(480, window.innerWidth - 32);
      var left = rect.left + rect.width / 2 - tw / 2;
      if (left < 8) left = 8;
      if (left + tw > window.innerWidth - 8) left = window.innerWidth - 8 - tw;
      tip.style.width = tw + 'px';
      tip.style.left = left + 'px';
      var above = rect.top - 8;
      var below = window.innerHeight - rect.bottom - 8;
      if (above > below) {
        tip.style.bottom = (window.innerHeight - rect.top + 8) + 'px';
        tip.style.top = 'auto';
      } else {
        tip.style.top = (rect.bottom + 8) + 'px';
        tip.style.bottom = 'auto';
      }
    }
    function hide() {
      hideTimer = setTimeout(function() { tip.setAttribute('hidden', ''); }, 120);
    }
    links.forEach(function(a) {
      a.addEventListener('mouseenter', show);
      a.addEventListener('mouseleave', hide);
    });
    tip.addEventListener('mouseenter', function() { clearTimeout(hideTimer); });
    tip.addEventListener('mouseleave', hide);
    document.addEventListener('keydown', function(e) {
      if (e.key === 'Escape') {
        var open = document.querySelector('.lightbox-toggle:checked');
        if (open) open.checked = false;
      }
    });
  })();
  </script>
</body>
</html>
